<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 id="ams-library">AMS Library</h1>

<p>Documentation: <a href="http://aleksessoft.com/docs/ams-lib/latest">http://aleksessoft.com/docs/ams-lib/latest</a></p>

<h2 id="description">Description</h2>

<p>AMS Library is a collection of functions and utilities for interacting with
SketchUp window and its input procedures via the Microsoft Windows API. Features
include switching SketchUp full screen, monitoring window state changes,
monitoring keyboard and mouse events, and preventing the interference of
SketchUp keyboard and mouse shortcut accelerators. Such features provide
extension developers with additional control over their tool. In addition to
utilizing <code>Sketchup::Tool</code> events, a developer can utilize AMS Library&#39;s keyboard
and mouse callback functions to receive input of all the messages, including the
mouse wheel. AMS Library&#39;s callback events are registered in form of observers
(although they are also modifiers), meaning a tool does not necessarily have to
be an active tool in order to receive input events. This allows for operating
extensions while other extensions are operating. In addition to the observer and
modifier procedures, AMS Library provides Windows API functionality for tweaking
dialogs to a next level, including removing the surrounding window frame and
applying window transparency. Furthermore, AMS Library comes with various
geometry and entity hierarchy manipulation functions. In a way, AMS Library
provides developers with functionality not achievable with SketchUp Ruby API.</p>

<h2 id="purpose">Purpose</h2>

<p>To provide extension developers with more control over their tool via an
additional API.</p>

<h2 id="usage">Usage</h2>

<p>AMS Library is intended to be a dependency extension for other extensions.
Extensions planning to use AMS Library need to verify AMS Library, of a specific
version, is installed, shown in the following sample:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># FILE: main_entry.rb
</span>
<span class='id identifier rubyid_tload_me'>tload_me</span> <span class='op'>=</span> <span class='kw'>true</span>

<span class='comment'># Load and verify AMS Library
</span><span class='kw'>begin</span>
  <span class='comment'># Attempt to load
</span>  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ams_Lib/main</span><span class='tstring_end'>&#39;</span></span>

  <span class='comment'># Verify version
</span>  <span class='id identifier rubyid_tload_me'>tload_me</span> <span class='op'>=</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="AMS.html" title="AMS (module)">AMS</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="AMS/Lib.html" title="AMS::Lib (module)">Lib</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="AMS/Lib.html#VERSION-constant" title="AMS::Lib::VERSION (constant)">VERSION</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>&lt;</span> <span class='float'>3.6</span>

<span class='kw'>rescue</span> <span class='const'>LoadError</span>
  <span class='id identifier rubyid_tload_me'>tload_me</span> <span class='op'>=</span> <span class='kw'>false</span>

<span class='kw'>end</span>

<span class='kw'>if</span> <span class='id identifier rubyid_tload_me'>tload_me</span>
  <span class='comment'># Load the main file
</span>  <span class='id identifier rubyid_cfpath'>cfpath</span> <span class='op'>=</span> <span class='kw'>__FILE__</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid_cfpath'>cfpath</span><span class='period'>.</span><span class='id identifier rubyid_force_encoding'>force_encoding</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UTF-8</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_cfpath'>cfpath</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:force_encoding</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_dir'>dir</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='id identifier rubyid_cfpath'>cfpath</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_require'>require</span> <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_dir'>dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>main</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

<span class='kw'>else</span>
  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[MY_EXTENSION_NAME] requires AMS Library, version 3.6.0 or later! </span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This extension will not be loaded with the library not installed or outdated. </span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Would you like to navigate to the library&#39;s download page?</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_tload_me'>tload_me</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>if</span> <span class='op'>::</span><span class='const'>UI</span><span class='period'>.</span><span class='id identifier rubyid_messagebox'>messagebox</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='comma'>,</span> <span class='const'>MB_YESNO</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='const'>IDYES</span>
    <span class='op'>::</span><span class='const'>UI</span><span class='period'>.</span><span class='id identifier rubyid_openURL'>openURL</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://sketchucation.com/forums/viewtopic.php?f=323&amp;t=55067#p499835</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

<span class='kw'>end</span>
</code></pre>

<p>When registering your extension (e.g. from <code>my_Plugin.rb</code>), have it load the <code>main_entry.rb</code> file:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>MyPlugin</span>

  <span class='const'>MY_EXTENSION_NAME</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MY Plugin</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_cfpath'>cfpath</span> <span class='op'>=</span> <span class='kw'>__FILE__</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid_cfpath'>cfpath</span><span class='period'>.</span><span class='id identifier rubyid_force_encoding'>force_encoding</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UTF-8</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_cfpath'>cfpath</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:force_encoding</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_efpath'>efpath</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>../my_Plugin/main_entry</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_cfpath'>cfpath</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_extension'>extension</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>SketchupExtension</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>MY_EXTENSION_NAME</span><span class='comma'>,</span> <span class='id identifier rubyid_efpath'>efpath</span><span class='rparen'>)</span>

  <span class='comment'># ...
</span>
<span class='kw'>end</span>
</code></pre>

<p>The presented plugin structure is as follows:</p>

<ul>
<li><p><code>my_Plugin</code> - folder</p>

<ul>
<li><code>main_entry.rb</code> - loaded by <code>my_Plugin.rb</code></li>
<li><code>main.rb</code> - loaded by <code>main_entry.rb</code></li>
<li>other files... - loaded by <code>main.rb</code></li>
</ul></li>
<li><p><code>my_Plugin.rb</code> - file that calls <code>my_Plugin/main_entry.rb</code></p></li>
</ul>

<p>Next section shows a few examples of what could be utilized in the <code>main.rb</code>
file, which is conditionally loaded in the <code>main_entry.rb</code> file.</p>

<h2 id="examples">Examples</h2>

<p>The following sections show a few examples regarding the use of AMS Library.
All functions and utilities are available in the documentation.</p>

<h3 id="using-observers-and-modifiers">Using Observers and Modifiers</h3>

<pre class="code ruby"><code class="ruby"><span class='comment'># FILE: main.rb
</span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ams_Lib/main</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Monitoring and processing SketchUp window events.
</span><span class='kw'>class</span> <span class='const'>MySketchupObserver</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_swo_on_switch_full_screen'>swo_on_switch_full_screen</span><span class='lparen'>(</span><span class='id identifier rubyid_state'>state</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_state'>state</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Main window switched full screen!</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Main window switched to original placement.</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># @see AMS::SketchupObserver.#swp_on_mouse_wheel_rotate
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_swp_on_mouse_wheel_rotate'>swp_on_mouse_wheel_rotate</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='comma'>,</span> <span class='id identifier rubyid_dir'>dir</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mouse wheel rotated - pos : (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_x'>x</span><span class='embexpr_end'>}</span><span class='tstring_content'>, </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_y'>y</span><span class='embexpr_end'>}</span><span class='tstring_content'>), dir : </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dir'>dir</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='comment'># Prevent mouse wheel from interacting with SU window. Returning 1 means
</span>    <span class='comment'># mouse wheel zoom in/out operation would be blocked, which might be
</span>    <span class='comment'># handy for those seeking more control over SketchUp window. Returning
</span>    <span class='comment'># any other value won&#39;t block the event.
</span>    <span class='kw'>return</span> <span class='int'>1</span>
  <span class='kw'>end</span>

<span class='kw'>end</span> <span class='comment'># class MySketchupObserver
</span>
<span class='kw'>unless</span> <span class='id identifier rubyid_file_loaded?'>file_loaded?</span><span class='lparen'>(</span><span class='kw'>__FILE__</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_file_loaded'>file_loaded</span><span class='lparen'>(</span><span class='kw'>__FILE__</span><span class='rparen'>)</span>

  <span class='comment'># Register the observer
</span>  <span class='const'><span class='object_link'><a href="AMS.html" title="AMS (module)">AMS</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="AMS/Sketchup.html" title="AMS::Sketchup (module)">Sketchup</a></span></span><span class='period'>.</span><span class='id identifier rubyid_add_observer'><span class='object_link'><a href="AMS/Sketchup.html#add_observer-class_method" title="AMS::Sketchup.add_observer (method)">add_observer</a></span></span><span class='lparen'>(</span><span class='const'>MySketchupObserver</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</code></pre>

<h3 id="switching-full-screen-on-single-monitor">Switching Full Screen on Single Monitor</h3>

<pre class="code ruby"><code class="ruby"><span class='comment'># Setting SketchUp full screen on the monitor SU window is associated to.
</span><span class='const'><span class='object_link'><a href="AMS.html" title="AMS (module)">AMS</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="AMS/Sketchup.html" title="AMS::Sketchup (module)">Sketchup</a></span></span><span class='period'>.</span><span class='id identifier rubyid_switch_full_screen'><span class='object_link'><a href="AMS/Sketchup.html#switch_full_screen-class_method" title="AMS::Sketchup.switch_full_screen (method)">switch_full_screen</a></span></span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
</code></pre>

<h3 id="switching-full-screen-on-multiple-monitors">Switching Full Screen on Multiple Monitors</h3>

<pre class="code ruby"><code class="ruby"><span class='comment'># Setting SketchUp full screen on all monitors.
</span><span class='const'><span class='object_link'><a href="AMS.html" title="AMS (module)">AMS</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="AMS/Sketchup.html" title="AMS::Sketchup (module)">Sketchup</a></span></span><span class='period'>.</span><span class='id identifier rubyid_switch_full_screen'><span class='object_link'><a href="AMS/Sketchup.html#switch_full_screen-class_method" title="AMS::Sketchup.switch_full_screen (method)">switch_full_screen</a></span></span><span class='lparen'>(</span><span class='kw'>true</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span>
</code></pre>

<h3 id="obtaining-handle-to-main-window">Obtaining Handle to Main Window</h3>

<pre class="code ruby"><code class="ruby"><span class='comment'># Get handle to SketchUp window.
</span><span class='const'><span class='object_link'><a href="AMS.html" title="AMS (module)">AMS</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="AMS/Sketchup.html" title="AMS::Sketchup (module)">Sketchup</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_main_window'><span class='object_link'><a href="AMS/Sketchup.html#get_main_window-class_method" title="AMS::Sketchup.get_main_window (method)">get_main_window</a></span></span>
</code></pre>

<h2 id="requirements">Requirements</h2>

<ul>
<li>Microsoft Windows XP or later</li>
<li>Mac OS X 10.8 or later, 64bit only</li>
<li>SketchUp 6 or later</li>
</ul>

<h2 id="installation-instructions">Installation Instructions</h2>

<p>AMS Library releases are available at <em>Extension Warehouse</em> or <em>SketchUcation PluginStore</em>.</p>

<p>To download from the repository, do the following:</p>

<ol>
<li>Compile binaries. See <strong>compile_instructions.md</strong> for details.</li>
<li>Copy <code>ams_Lib</code> folder and <code>ams_Lib.rb</code> from <code>./ext-ruby/</code>, to your plugins folder.</li>
</ol>
</div></div>

      <div id="footer">
  Generated on Wed May 26 20:05:41 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.7.1).
</div>

    </div>
  </body>
</html>